<div class="convert-json-container">
  <h2>{{ 'convertJsonToExcel.title' | translate }}</h2>

  <div class="description">
    <p>{{ 'convertJsonToExcel.description' | translate }}</p>
    <p class="format-info" [innerHTML]="'convertJsonToExcel.formatInfo' | translate"></p>
  </div>

  <div class="upload-section">
    <div class="file-input-wrapper">
      <label for="fileInput" class="file-label">
        <span class="icon">üìÅ</span>
        <span>{{ 'convertJsonToExcel.chooseFiles' | translate }}</span>
      </label>
      <input
        id="fileInput"
        type="file"
        accept=".json"
        multiple
        (change)="onFileSelected($event)"
        class="file-input"
      />
    </div>

    @if (selectedFiles.length > 0) {
      <div class="file-list">
        <h3>{{ 'convertJsonToExcel.selectedFiles' | translate }} ({{ selectedFiles.length }}):</h3>
        <ul>
          @for (file of selectedFiles; track file.name) {
            <li>
              {{ file.name }} <span class="file-size">({{ (file.size / 1024).toFixed(2) }} KB)</span>
            </li>
          }
        </ul>
      </div>
    }

    <div class="format-selection">
      <label for="formatSelect">{{ 'convertJsonToExcel.outputFormat' | translate }}:</label>
      <select id="formatSelect" (change)="onFormatChange($event)" [value]="outputFormat">
        <option value="xlsx">{{ 'convertJsonToExcel.excel' | translate }}</option>
        <option value="csv">{{ 'convertJsonToExcel.csv' | translate }}</option>
      </select>
    </div>

    <div class="actions">
      <button
        class="btn btn-primary"
        (click)="convertFiles()"
        [disabled]="isProcessing || selectedFiles.length === 0"
      >
        @if (!isProcessing) {
          <span>üîÑ {{ 'convertJsonToExcel.convertButton' | translate }}</span>
        }
        @if (isProcessing) {
          <span>‚è≥ {{ 'convertJsonToExcel.processing' | translate }}</span>
        }
      </button>

      <button
        class="btn btn-secondary"
        (click)="reset()"
        [disabled]="isProcessing"
      >
        ‚Ü∫ {{ 'convertJsonToExcel.resetButton' | translate }}
      </button>
    </div>

    @if (errorMessage) {
      <div class="message error">
        ‚ö†Ô∏è {{ errorMessage }}
      </div>
    }

    @if (successMessage) {
      <div class="message success">
        ‚úì {{ successMessage }}
      </div>
    }
  </div>
</div>
